{"ast":null,"code":"var _jsxFileName = \"E:\\\\programData\\\\React\\\\user\\\\src\\\\components\\\\common\\\\layout\\\\header.tsx\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/* eslint-disable no-return-assign */\nimport React, { PureComponent } from 'react';\nimport { SettingOutlined, HeartOutlined, MessageOutlined, UserOutlined, LogoutOutlined, SearchOutlined, CloseOutlined, BellOutlined } from '@ant-design/icons';\nimport { FundsIcon } from '@components/common/base/icons';\nimport { Layout, Menu, Avatar, Input, Button, Dropdown, Badge, Card, message, Tooltip } from 'antd';\nimport { messageService } from 'src/services/index';\nimport { createSelector } from 'reselect';\nimport { connect } from 'react-redux';\nimport Link from 'next/link';\nimport Router, { withRouter } from 'next/router';\nimport { logout } from '@redux/auth/actions';\nimport { getPerformerCategories, updateCurrentPerformerBalance } from '@redux/performer/actions';\nimport { getCountries } from '@redux/settings/actions';\nimport { SocketContext } from 'src/socket';\nimport { addPrivateRequest } from '@redux/streaming/actions';\nimport { formatDate } from 'src/lib';\nimport { getStudioStats } from 'src/redux/studio/actions';\nimport { countNotReadMessage } from '@redux/message/actions'; // import NumberFormat from '@components/common/layout/numberformat';\n\nimport './header.less';\nimport { SETTING_KEYS } from 'src/constants';\nimport LeftHeaderContent from './left-header-content';\n\nconst roundBalance = balance => {\n  if (balance < 10000) return Math.round(balance);\n  return '9999+';\n};\n\nconst EVENT = {\n  RECEIVED_PRIVATE_CHAT_REQUEST: 'private-chat-request',\n  NOTIFY_READ_MESSAGE: 'nofify_read_messages_in_conversation',\n  TIPPED: 'tipped'\n};\n\nclass Header extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"socket\", void 0);\n\n    _defineProperty(this, \"_audio\", void 0);\n\n    _defineProperty(this, \"handleMessage\", event => {\n      const {\n        countNotReadMessage: dispatchCountNotReadMessage\n      } = this.props;\n      event && dispatchCountNotReadMessage(event.total);\n    });\n\n    _defineProperty(this, \"handlePrivateChat\", data => {\n      const {\n        addPrivateRequest: dispatchAddPrivateRequest,\n        settings\n      } = this.props;\n      const path = settings[SETTING_KEYS.OPTION_FOR_PRIVATE] === 'webrtc' ? 'webrtc/' : '';\n      message.success({\n        content: __jsx(\"span\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 9\n          }\n        }, data.user.username, ' ', \"sent you a private chat request.\"),\n        duration: 10,\n        key: data.conversationId,\n        onClick: () => {\n          Router.push({\n            pathname: `/live/${path}privatechat`,\n            query: {\n              id: data.conversationId,\n              streamId: data.id\n            }\n          }, `/live/${path}privatechat/${data.conversationId}`);\n          message.destroy(data.conversationId);\n        }\n      });\n      this._audio && this._audio.play();\n      dispatchAddPrivateRequest(_objectSpread(_objectSpread({}, data), {}, {\n        createdAt: new Date()\n      }));\n    });\n\n    _defineProperty(this, \"sendTipHandler\", ({\n      senderInfo,\n      netPrice,\n      token\n    }) => {\n      const {\n        updateCurrentPerformerBalance: dispatchUpdateCurrentPerformerBalance\n      } = this.props;\n      message.success(`${senderInfo.username} has tipped ${token === null || token === void 0 ? void 0 : token.toFixed(2)} tokens. You have received ${netPrice === null || netPrice === void 0 ? void 0 : netPrice.toFixed(2)}`, 10);\n      dispatchUpdateCurrentPerformerBalance(netPrice);\n      this._audio && this._audio.play();\n    });\n\n    _defineProperty(this, \"initSocketEvent\", () => {\n      this.socket = this.context;\n      const {\n        currentUser\n      } = this.props;\n\n      if (this.socket.connected) {\n        if (currentUser.role === 'performer') {\n          this.socket.on(EVENT.RECEIVED_PRIVATE_CHAT_REQUEST, this.handlePrivateChat);\n          this.socket.on(EVENT.TIPPED, this.sendTipHandler);\n        }\n\n        this.socket.on(EVENT.NOTIFY_READ_MESSAGE, this.handleMessage);\n      } else {\n        this.socket.on('connect', () => {\n          if (currentUser.role === 'performer') {\n            this.socket.on(EVENT.RECEIVED_PRIVATE_CHAT_REQUEST, this.handlePrivateChat);\n            this.socket.on(EVENT.TIPPED, this.sendTipHandler);\n          }\n\n          this.socket.on(EVENT.NOTIFY_READ_MESSAGE, this.handleMessage);\n        });\n      }\n    });\n\n    this.state = {\n      showSearch: false\n    };\n  }\n\n  async componentDidMount() {\n    const {\n      getPerformerCategories: dispatchGetPerformerCategories,\n      getCountries: dispatchGetCountries,\n      getStudioStats: dispatchGetStudioStats,\n      currentUser,\n      loggedIn,\n      tipSound,\n      countNotReadMessage: dispatchCountNotReadMessage\n    } = this.props; // this.socket = this.context;\n\n    dispatchGetPerformerCategories({\n      limit: 0\n    });\n    dispatchGetCountries();\n\n    if (currentUser !== null && currentUser !== void 0 && currentUser._id) {\n      const data = await (await messageService.countTotalNotRead()).data;\n\n      if (data) {\n        dispatchCountNotReadMessage(data.total);\n      }\n    }\n\n    if (currentUser !== null && currentUser !== void 0 && currentUser._id && currentUser.role === 'studio') {\n      dispatchGetStudioStats();\n    }\n\n    if (loggedIn) {\n      this.initSocketEvent();\n      this.checkPermissionAccess();\n    }\n\n    this._audio = new Audio(tipSound);\n    this._audio.volume = 0.5;\n  }\n\n  componentDidUpdate(prevProps) {\n    const {\n      loggedIn,\n      router: {\n        query: {\n          unauthorized\n        }\n      }\n    } = this.props;\n\n    if (loggedIn && prevProps.loggedIn !== loggedIn) {\n      setTimeout(this.initSocketEvent, 1000);\n    }\n\n    if (unauthorized !== prevProps.router.query.unauthorized) {\n      this.checkPermissionAccess();\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.socket) {\n      this.socket.off(EVENT.NOTIFY_READ_MESSAGE);\n      this.socket.off(EVENT.RECEIVED_PRIVATE_CHAT_REQUEST);\n      this.socket.off(EVENT.TIPPED);\n    }\n  }\n\n  onSearchPerformer(key) {\n    this.search(key);\n  }\n\n  onPressEnter(event) {\n    const target = event.currentTarget;\n    const key = target.value;\n    this.search(key);\n  }\n\n  search(key) {\n    Router.push({\n      pathname: '/',\n      query: {\n        q: key\n      }\n    }, `/?q=${key}`);\n  }\n\n  async checkPermissionAccess() {\n    const {\n      loggedIn,\n      router: {\n        query: {\n          unauthorized\n        }\n      }\n    } = this.props;\n\n    if (!loggedIn || !unauthorized) {\n      return;\n    }\n\n    this.beforeLogout();\n  }\n\n  async beforeLogout() {\n    const {\n      logout: dispatchLogout\n    } = this.props;\n    dispatchLogout();\n  }\n\n  render() {\n    const {\n      ui,\n      loggedIn,\n      privateRequests,\n      currentUser,\n      totalNotReadMessage,\n      settings\n    } = this.props;\n    const {\n      showSearch\n    } = this.state;\n    const path = settings[SETTING_KEYS.OPTION_FOR_PRIVATE] === 'webrtc' ? 'webrtc/' : '';\n    const rightContent = loggedIn ? __jsx(React.Fragment, null, __jsx(Link, {\n      href: currentUser.role === 'user' ? '/account/user/funds-tokens' : currentUser.role === 'performer' ? '/account/performer/payout-requests' : '#',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 9\n      }\n    }, __jsx(\"a\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 11\n      }\n    }, __jsx(Tooltip, {\n      title: `${currentUser.balance && currentUser.balance.toFixed(2) || 0} Tokens`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 13\n      }\n    }, __jsx(Button, {\n      style: {\n        margin: '0px 10px',\n        color: '#ff0066'\n      },\n      className: \"btn-tokens\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 15\n      }\n    }, `${roundBalance((currentUser === null || currentUser === void 0 ? void 0 : currentUser.balance) || 0)} Tokens`)))), currentUser.role === 'performer' && __jsx(Dropdown, {\n      overlay: __jsx(Menu, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 15\n        }\n      }, privateRequests.length > 0 ? privateRequests.map(request => {\n        var _request$user, _request$user2, _request$user3;\n\n        return __jsx(Menu.Item, {\n          onClick: () => message.destroy(request.conversationId),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 314,\n            columnNumber: 21\n          }\n        }, __jsx(Link, {\n          href: {\n            pathname: `/live/${path}privatechat`,\n            query: {\n              id: request.conversationId,\n              streamId: request.id\n            }\n          },\n          as: `/live/${path}privatechat/${request.conversationId}?streamId=${request.id}`,\n          key: request.conversationId,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 23\n          }\n        }, __jsx(\"a\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 25\n          }\n        }, __jsx(Card, {\n          bordered: false,\n          hoverable: false,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 329,\n            columnNumber: 27\n          }\n        }, __jsx(Card.Meta, {\n          avatar: __jsx(Avatar, {\n            src: ((_request$user = request.user) === null || _request$user === void 0 ? void 0 : _request$user.avatar) || '/default-user-icon.png',\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 332,\n              columnNumber: 33\n            }\n          }),\n          title: `${((_request$user2 = request.user) === null || _request$user2 === void 0 ? void 0 : _request$user2.username) || 'N/A'} (${roundBalance(((_request$user3 = request.user) === null || _request$user3 === void 0 ? void 0 : _request$user3.balance) || 0)} token(s))`,\n          description: formatDate(request === null || request === void 0 ? void 0 : request.createdAt),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 29\n          }\n        })))));\n      }) : __jsx(Menu.Item, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 19\n        }\n      }, \"There are no private request.\")),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 11\n      }\n    }, __jsx(\"span\", {\n      className: \"call-requests\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 13\n      }\n    }, __jsx(Badge, {\n      count: privateRequests.length,\n      showZero: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 15\n      }\n    }, __jsx(BellOutlined, {\n      style: {\n        color: '#ffffff'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 17\n      }\n    })))), __jsx(Dropdown, {\n      overlay: __jsx(Menu, {\n        key: \"menu-right-content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 13\n        }\n      }, currentUser.role === 'user' && [__jsx(Menu.Item, {\n        key: \"settings-menu-right-content\",\n        onClick: () => Router.push('/account/user/account-settings'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 17\n        }\n      }, __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 19\n        }\n      }, __jsx(SettingOutlined, {\n        className: \"primary-icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 21\n        }\n      }), ' ', \"Profile\")), __jsx(Menu.Item, {\n        key: \"favorite-menu-right-content\",\n        onClick: () => Router.push('/account/user/favorites'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 17\n        }\n      }, __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 19\n        }\n      }, __jsx(HeartOutlined, {\n        className: \"primary-icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 379,\n          columnNumber: 21\n        }\n      }), ' ', \"My Favorites\")), __jsx(Menu.Item, {\n        key: \"funds-tokens-menu-right-content\",\n        onClick: () => Router.push('/account/user/funds-tokens'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 17\n        }\n      }, __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 19\n        }\n      }, __jsx(\"span\", {\n        className: \"anticon primary-icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 21\n        }\n      }, __jsx(FundsIcon, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 23\n        }\n      })), ' ', \"Funds / Tokens\")), __jsx(Menu.Item, {\n        key: \"user-messages-menu-right-content\",\n        onClick: () => Router.push('/messages'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 17\n        }\n      }, __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 400,\n          columnNumber: 19\n        }\n      }, __jsx(MessageOutlined, {\n        className: \"primary-icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 21\n        }\n      }), ' ', \"Messages (\", totalNotReadMessage || 0, \")\"))], currentUser.role === 'performer' && [__jsx(Menu.Item, {\n        key: \"profile-menu-right-content\",\n        onClick: () => Router.push('/account/performer/profile'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 17\n        }\n      }, __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 19\n        }\n      }, __jsx(UserOutlined, {\n        className: \"primary-icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 21\n        }\n      }), ' ', \"Profile\")), __jsx(Menu.Item, {\n        key: \"account-settings-menu-right-content\",\n        onClick: () => Router.push('/account/performer/account-settings'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 17\n        }\n      }, __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 19\n        }\n      }, __jsx(SettingOutlined, {\n        className: \"primary-icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 21\n        }\n      }), ' ', \"Account Settings\")), __jsx(Menu.Item, {\n        key: \"model-messages-menu-right-content\",\n        onClick: () => Router.push('/messages'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 432,\n          columnNumber: 17\n        }\n      }, __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 19\n        }\n      }, __jsx(MessageOutlined, {\n        className: \"primary-icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 437,\n          columnNumber: 21\n        }\n      }), ' ', \"Messages (\", totalNotReadMessage, \")\"))], currentUser.role === 'studio' && [__jsx(Menu.Item, {\n        key: \"account-settings-menu-right-content\",\n        onClick: () => Router.push('/studio/account-settings'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 17\n        }\n      }, __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 19\n        }\n      }, __jsx(SettingOutlined, {\n        className: \"primary-icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 21\n        }\n      }), ' ', \"Account Settings\"))], __jsx(Menu.Item, {\n        key: \"log-out\",\n        onClick: this.beforeLogout.bind(this),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 458,\n          columnNumber: 15\n        }\n      }, __jsx(LogoutOutlined, {\n        className: \"primary-icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 17\n        }\n      }), ' ', \"Log out\")),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 9\n      }\n    }, __jsx(Avatar, {\n      style: {\n        margin: '0 15px',\n        cursor: 'pointer',\n        background: '#ffffff'\n      },\n      src: (currentUser === null || currentUser === void 0 ? void 0 : currentUser.avatar) || '/default-user-icon.png',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 466,\n        columnNumber: 11\n      }\n    }))) : __jsx(Button, {\n      className: \"btn-login\",\n      onClick: () => Router.push('/auth/login/user', '/auth/login'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 7\n      }\n    }, \"Login\");\n    return __jsx(Layout.Header, {\n      className: \"header\",\n      id: \"layoutHeader\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 486,\n        columnNumber: 7\n      }\n    }, __jsx(\"div\", {\n      className: \"left-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 487,\n        columnNumber: 9\n      }\n    }, __jsx(Link, {\n      href: \"/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 488,\n        columnNumber: 11\n      }\n    }, __jsx(\"a\", {\n      className: \"header-logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 489,\n        columnNumber: 13\n      }\n    }, __jsx(\"img\", {\n      src: typeof ui.logo === 'string' && ui.logo.length > 0 ? ui.logo : '/xcam-logo-white.png',\n      alt: \"header-logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 490,\n        columnNumber: 15\n      }\n    }))), __jsx(\"div\", {\n      className: \"menu-left-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 500,\n        columnNumber: 11\n      }\n    }, __jsx(LeftHeaderContent, _extends({}, this.props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 501,\n        columnNumber: 13\n      }\n    })))), __jsx(\"div\", {\n      className: \"right-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 504,\n        columnNumber: 9\n      }\n    }, __jsx(\"div\", {\n      className: showSearch ? 'search-icon active' : 'search-icon',\n      \"aria-hidden\": true,\n      onClick: () => this.setState({\n        showSearch: !showSearch\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 11\n      }\n    }, showSearch ? __jsx(CloseOutlined, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 510,\n        columnNumber: 27\n      }\n    }) : __jsx(SearchOutlined, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 510,\n        columnNumber: 47\n      }\n    })), __jsx(\"div\", {\n      className: !showSearch ? 'hide search-bar' : 'search-bar',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 512,\n        columnNumber: 11\n      }\n    }, __jsx(Input.Search, {\n      placeholder: \"Enter keyword\",\n      loading: false,\n      allowClear: true,\n      enterButton: true,\n      onPressEnter: this.onPressEnter.bind(this),\n      onSearch: this.onSearchPerformer.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 513,\n        columnNumber: 13\n      }\n    })), rightContent));\n  }\n\n}\n\nHeader.contextType = SocketContext;\n\nconst userSelecter = state => state.user.current;\n\nconst performerSelecter = state => state.performer.current;\n\nconst studioSelecter = state => state.studio.current;\n\nconst authSelecter = state => state.auth;\n\nconst currentUserSelecter = createSelector(userSelecter, performerSelecter, studioSelecter, authSelecter, (user, performer, studio, auth) => {\n  if (!auth.loggedIn) return {};\n\n  if (user !== null && user !== void 0 && user._id) {\n    return _objectSpread(_objectSpread({}, user), {}, {\n      role: 'user'\n    });\n  }\n\n  if (performer !== null && performer !== void 0 && performer._id) {\n    return _objectSpread(_objectSpread({}, performer), {}, {\n      role: 'performer'\n    });\n  }\n\n  if (studio !== null && studio !== void 0 && studio._id) {\n    return _objectSpread(_objectSpread({}, studio), {}, {\n      role: 'studio'\n    });\n  }\n\n  return {};\n});\nHeader.contextType = SocketContext;\n\nconst mapStateToProps = state => _objectSpread({\n  ui: _objectSpread({}, state.ui),\n  currentUser: currentUserSelecter(state),\n  tipSound: state.settings.tipSound,\n  loggedIn: state.auth.loggedIn,\n  performerCategories: state.performer.categories,\n  totalNotReadMessage: state.message.totalNotReadMessage\n}, state.streaming);\n\nconst mapDispatch = {\n  logout,\n  getPerformerCategories,\n  getCountries,\n  addPrivateRequest,\n  getStudioStats,\n  countNotReadMessage,\n  updateCurrentPerformerBalance\n};\nexport default connect(mapStateToProps, mapDispatch)(withRouter(Header));","map":{"version":3,"sources":["E:/programData/React/user/src/components/common/layout/header.tsx"],"names":["React","PureComponent","SettingOutlined","HeartOutlined","MessageOutlined","UserOutlined","LogoutOutlined","SearchOutlined","CloseOutlined","BellOutlined","FundsIcon","Layout","Menu","Avatar","Input","Button","Dropdown","Badge","Card","message","Tooltip","messageService","createSelector","connect","Link","Router","withRouter","logout","getPerformerCategories","updateCurrentPerformerBalance","getCountries","SocketContext","addPrivateRequest","formatDate","getStudioStats","countNotReadMessage","SETTING_KEYS","LeftHeaderContent","roundBalance","balance","Math","round","EVENT","RECEIVED_PRIVATE_CHAT_REQUEST","NOTIFY_READ_MESSAGE","TIPPED","Header","constructor","props","event","dispatchCountNotReadMessage","total","data","dispatchAddPrivateRequest","settings","path","OPTION_FOR_PRIVATE","success","content","user","username","duration","key","conversationId","onClick","push","pathname","query","id","streamId","destroy","_audio","play","createdAt","Date","senderInfo","netPrice","token","dispatchUpdateCurrentPerformerBalance","toFixed","socket","context","currentUser","connected","role","on","handlePrivateChat","sendTipHandler","handleMessage","state","showSearch","componentDidMount","dispatchGetPerformerCategories","dispatchGetCountries","dispatchGetStudioStats","loggedIn","tipSound","limit","_id","countTotalNotRead","initSocketEvent","checkPermissionAccess","Audio","volume","componentDidUpdate","prevProps","router","unauthorized","setTimeout","componentWillUnmount","off","onSearchPerformer","search","onPressEnter","target","currentTarget","value","q","beforeLogout","dispatchLogout","render","ui","privateRequests","totalNotReadMessage","rightContent","margin","color","length","map","request","avatar","bind","cursor","background","logo","setState","contextType","userSelecter","current","performerSelecter","performer","studioSelecter","studio","authSelecter","auth","currentUserSelecter","mapStateToProps","performerCategories","categories","streaming","mapDispatch"],"mappings":"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","sourcesContent":["/* eslint-disable no-return-assign */\nimport React, { PureComponent } from 'react';\nimport {\n  SettingOutlined,\n  HeartOutlined,\n  MessageOutlined,\n  UserOutlined,\n  LogoutOutlined,\n  SearchOutlined,\n  CloseOutlined,\n  BellOutlined\n} from '@ant-design/icons';\nimport { FundsIcon } from '@components/common/base/icons';\nimport {\n  Layout,\n  Menu,\n  Avatar,\n  Input,\n  Button,\n  Dropdown,\n  Badge,\n  Card,\n  message,\n  Tooltip\n} from 'antd';\nimport { messageService } from 'src/services/index';\nimport { createSelector } from 'reselect';\nimport { connect } from 'react-redux';\nimport Link from 'next/link';\nimport Router, { withRouter, NextRouter } from 'next/router';\nimport {\n  IUser,\n  IPerformerCategogies,\n  IDataResponse,\n  IPerformer,\n  IStudio,\n  IUIConfig,\n  StreamSettings\n} from 'src/interfaces';\nimport { logout } from '@redux/auth/actions';\nimport { getPerformerCategories, updateCurrentPerformerBalance } from '@redux/performer/actions';\nimport { getCountries } from '@redux/settings/actions';\nimport { SocketContext } from 'src/socket';\nimport { addPrivateRequest } from '@redux/streaming/actions';\nimport { formatDate } from 'src/lib';\nimport { getStudioStats } from 'src/redux/studio/actions';\nimport { countNotReadMessage } from '@redux/message/actions';\n// import NumberFormat from '@components/common/layout/numberformat';\nimport './header.less';\nimport { SETTING_KEYS } from 'src/constants';\nimport LeftHeaderContent from './left-header-content';\n\nconst roundBalance = (balance: number) => {\n  if (balance < 10000) return Math.round(balance);\n  return '9999+';\n};\n\nconst EVENT = {\n  RECEIVED_PRIVATE_CHAT_REQUEST: 'private-chat-request',\n  NOTIFY_READ_MESSAGE: 'nofify_read_messages_in_conversation',\n  TIPPED: 'tipped'\n};\n\ninterface P {\n  collapsed?: boolean;\n  onCollapseChange?: Function;\n  loggedIn?: boolean;\n  logout?: Function;\n  ui?: IUIConfig;\n  getCountries?: Function;\n  getPerformerCategories?: Function;\n  performerCategories?: IDataResponse<IPerformerCategogies>;\n  searchPerformer?: Function;\n  addPrivateRequest?: Function;\n  countNotReadMessage?: Function;\n  updateCurrentPerformerBalance?: Function;\n  totalNotReadMessage?: number;\n  router: NextRouter;\n  privateRequests?: any;\n  getStudioStats?: Function;\n  role?: string;\n  tipSound?: string;\n  currentUser?: IUser & IPerformer & IStudio;\n  settings?: StreamSettings;\n}\n\ninterface S {\n  showSearch: boolean;\n}\n\nclass Header extends PureComponent<P, S> {\n  private socket: SocketIOClient.Socket;\n\n  private _audio: HTMLAudioElement;\n\n  constructor(props: P) {\n    super(props);\n    this.state = {\n      showSearch: false\n    };\n  }\n\n  async componentDidMount() {\n    const {\n      getPerformerCategories: dispatchGetPerformerCategories,\n      getCountries: dispatchGetCountries,\n      getStudioStats: dispatchGetStudioStats,\n      currentUser,\n      loggedIn,\n      tipSound,\n      countNotReadMessage: dispatchCountNotReadMessage\n    } = this.props;\n    // this.socket = this.context;\n    dispatchGetPerformerCategories({ limit: 0 });\n    dispatchGetCountries();\n    if (currentUser?._id) {\n      const data = await (await messageService.countTotalNotRead()).data;\n      if (data) {\n        dispatchCountNotReadMessage(data.total);\n      }\n    }\n\n    if (currentUser?._id && currentUser.role === 'studio') {\n      dispatchGetStudioStats();\n    }\n\n    if (loggedIn) {\n      this.initSocketEvent();\n      this.checkPermissionAccess();\n    }\n\n    this._audio = new Audio(tipSound);\n    this._audio.volume = 0.5;\n  }\n\n  componentDidUpdate(prevProps: P) {\n    const {\n      loggedIn,\n      router: {\n        query: { unauthorized }\n      }\n    } = this.props;\n    if (loggedIn && prevProps.loggedIn !== loggedIn) {\n      setTimeout(this.initSocketEvent, 1000);\n    }\n\n    if (unauthorized !== prevProps.router.query.unauthorized) {\n      this.checkPermissionAccess();\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.socket) {\n      this.socket.off(EVENT.NOTIFY_READ_MESSAGE);\n      this.socket.off(EVENT.RECEIVED_PRIVATE_CHAT_REQUEST);\n      this.socket.off(EVENT.TIPPED);\n    }\n  }\n\n  onSearchPerformer(key: string) {\n    this.search(key);\n  }\n\n  onPressEnter(event) {\n    const target = event.currentTarget as HTMLInputElement;\n    const key = target.value;\n    this.search(key);\n  }\n\n  handleMessage = (event) => {\n    const { countNotReadMessage: dispatchCountNotReadMessage } = this.props;\n    event && dispatchCountNotReadMessage(event.total);\n  };\n\n  handlePrivateChat = (data: {\n    conversationId: string;\n    user: IUser;\n    id: string;\n  }) => {\n    const { addPrivateRequest: dispatchAddPrivateRequest, settings } = this.props;\n    const path = settings[SETTING_KEYS.OPTION_FOR_PRIVATE] === 'webrtc' ? 'webrtc/' : '';\n    message.success({\n      content: (\n        <span>\n          {data.user.username}\n          {' '}\n          sent you a private chat request.\n        </span>\n      ),\n      duration: 10,\n      key: data.conversationId,\n      onClick: () => {\n        Router.push(\n          {\n            pathname: `/live/${path}privatechat`,\n            query: {\n              id: data.conversationId,\n              streamId: data.id\n            }\n          },\n          `/live/${path}privatechat/${data.conversationId}`\n        );\n        message.destroy(data.conversationId);\n      }\n    });\n    this._audio && this._audio.play();\n    dispatchAddPrivateRequest({ ...data, createdAt: new Date() });\n  };\n\n  sendTipHandler = ({ senderInfo, netPrice, token }) => {\n    const { updateCurrentPerformerBalance: dispatchUpdateCurrentPerformerBalance } = this.props;\n    message.success(\n      `${senderInfo.username} has tipped ${token?.toFixed(2)} tokens. You have received ${netPrice?.toFixed(2)}`,\n      10\n    );\n    dispatchUpdateCurrentPerformerBalance(netPrice);\n    this._audio && this._audio.play();\n  };\n\n  initSocketEvent = () => {\n    this.socket = this.context;\n    const { currentUser } = this.props;\n    if (this.socket.connected) {\n      if (currentUser.role === 'performer') {\n        this.socket.on(\n          EVENT.RECEIVED_PRIVATE_CHAT_REQUEST,\n          this.handlePrivateChat\n        );\n        this.socket.on(EVENT.TIPPED, this.sendTipHandler);\n      }\n\n      this.socket.on(EVENT.NOTIFY_READ_MESSAGE, this.handleMessage);\n    } else {\n      this.socket.on('connect', () => {\n        if (currentUser.role === 'performer') {\n          this.socket.on(\n            EVENT.RECEIVED_PRIVATE_CHAT_REQUEST,\n            this.handlePrivateChat\n          );\n          this.socket.on(EVENT.TIPPED, this.sendTipHandler);\n        }\n\n        this.socket.on(EVENT.NOTIFY_READ_MESSAGE, this.handleMessage);\n      });\n    }\n  };\n\n  search(key: string) {\n    Router.push({ pathname: '/', query: { q: key } }, `/?q=${key}`);\n  }\n\n  async checkPermissionAccess() {\n    const {\n      loggedIn,\n      router: {\n        query: { unauthorized }\n      }\n    } = this.props;\n    if (!loggedIn || !unauthorized) {\n      return;\n    }\n\n    this.beforeLogout();\n  }\n\n  async beforeLogout() {\n    const { logout: dispatchLogout } = this.props;\n    dispatchLogout();\n  }\n\n  render() {\n    const {\n      ui,\n      loggedIn,\n      privateRequests,\n      currentUser,\n      totalNotReadMessage,\n      settings\n    } = this.props;\n    const { showSearch } = this.state;\n    const path = settings[SETTING_KEYS.OPTION_FOR_PRIVATE] === 'webrtc' ? 'webrtc/' : '';\n    const rightContent = loggedIn ? (\n      <>\n        <Link\n          href={\n            currentUser.role === 'user'\n              ? '/account/user/funds-tokens'\n              : currentUser.role === 'performer'\n                ? '/account/performer/payout-requests'\n                : '#'\n          }\n        >\n          <a>\n            <Tooltip\n              title={`${\n                (currentUser.balance && currentUser.balance.toFixed(2)) || 0\n              } Tokens`}\n            >\n              <Button\n                style={{ margin: '0px 10px', color: '#ff0066' }}\n                className=\"btn-tokens\"\n              >\n                {`${roundBalance(currentUser?.balance || 0)} Tokens`}\n              </Button>\n            </Tooltip>\n          </a>\n        </Link>\n        {currentUser.role === 'performer' && (\n          <Dropdown\n            overlay={(\n              <Menu>\n                {privateRequests.length > 0 ? (\n                  privateRequests.map((request) => (\n                    <Menu.Item\n                      onClick={() => message.destroy(request.conversationId)}\n                    >\n                      <Link\n                        href={{\n                          pathname: `/live/${path}privatechat`,\n                          query: {\n                            id: request.conversationId,\n                            streamId: request.id\n                          }\n                        }}\n                        as={`/live/${path}privatechat/${request.conversationId}?streamId=${request.id}`}\n                        key={request.conversationId}\n                      >\n                        <a>\n                          <Card bordered={false} hoverable={false}>\n                            <Card.Meta\n                              avatar={(\n                                <Avatar\n                                  src={\n                                    request.user?.avatar\n                                    || '/default-user-icon.png'\n                                  }\n                                />\n                              )}\n                              title={`${request.user?.username || 'N/A'} (${roundBalance(request.user?.balance || 0)} token(s))`}\n                              description={formatDate(request?.createdAt)}\n                            />\n                          </Card>\n                        </a>\n                      </Link>\n                    </Menu.Item>\n                  ))\n                ) : (\n                  <Menu.Item>There are no private request.</Menu.Item>\n                )}\n              </Menu>\n            )}\n          >\n            <span className=\"call-requests\">\n              <Badge count={privateRequests.length} showZero>\n                <BellOutlined style={{ color: '#ffffff' }} />\n              </Badge>\n            </span>\n          </Dropdown>\n        )}\n        <Dropdown\n          overlay={(\n            <Menu key=\"menu-right-content\">\n              {currentUser.role === 'user' && [\n                <Menu.Item\n                  key=\"settings-menu-right-content\"\n                  onClick={() => Router.push('/account/user/account-settings')}\n                >\n                  <span>\n                    <SettingOutlined className=\"primary-icon\" />\n                    {' '}\n                    Profile\n                  </span>\n                </Menu.Item>,\n                <Menu.Item\n                  key=\"favorite-menu-right-content\"\n                  onClick={() => Router.push('/account/user/favorites')}\n                >\n                  <span>\n                    <HeartOutlined className=\"primary-icon\" />\n                    {' '}\n                    My Favorites\n                  </span>\n                </Menu.Item>,\n                <Menu.Item\n                  key=\"funds-tokens-menu-right-content\"\n                  onClick={() => Router.push('/account/user/funds-tokens')}\n                >\n                  <span>\n                    <span className=\"anticon primary-icon\">\n                      <FundsIcon />\n                    </span>\n                    {' '}\n                    Funds / Tokens\n                  </span>\n                </Menu.Item>,\n                <Menu.Item\n                  key=\"user-messages-menu-right-content\"\n                  onClick={() => Router.push('/messages')}\n                >\n                  <span>\n                    <MessageOutlined className=\"primary-icon\" />\n                    {' '}\n                    Messages (\n                    {totalNotReadMessage || 0}\n                    )\n                  </span>\n                </Menu.Item>\n              ]}\n\n              {currentUser.role === 'performer' && [\n                <Menu.Item\n                  key=\"profile-menu-right-content\"\n                  onClick={() => Router.push('/account/performer/profile')}\n                >\n                  <span>\n                    <UserOutlined className=\"primary-icon\" />\n                    {' '}\n                    Profile\n                  </span>\n                </Menu.Item>,\n                <Menu.Item\n                  key=\"account-settings-menu-right-content\"\n                  onClick={() => Router.push('/account/performer/account-settings')}\n                >\n                  <span>\n                    <SettingOutlined className=\"primary-icon\" />\n                    {' '}\n                    Account\n                    Settings\n                  </span>\n                </Menu.Item>,\n                <Menu.Item\n                  key=\"model-messages-menu-right-content\"\n                  onClick={() => Router.push('/messages')}\n                >\n                  <span>\n                    <MessageOutlined className=\"primary-icon\" />\n                    {' '}\n                    Messages (\n                    {totalNotReadMessage}\n                    )\n                  </span>\n                </Menu.Item>\n              ]}\n              {currentUser.role === 'studio' && [\n                <Menu.Item\n                  key=\"account-settings-menu-right-content\"\n                  onClick={() => Router.push('/studio/account-settings')}\n                >\n                  <span>\n                    <SettingOutlined className=\"primary-icon\" />\n                    {' '}\n                    Account\n                    Settings\n                  </span>\n                </Menu.Item>\n              ]}\n              <Menu.Item key=\"log-out\" onClick={this.beforeLogout.bind(this)}>\n                <LogoutOutlined className=\"primary-icon\" />\n                {' '}\n                Log out\n              </Menu.Item>\n            </Menu>\n          )}\n        >\n          <Avatar\n            style={{\n              margin: '0 15px',\n              cursor: 'pointer',\n              background: '#ffffff'\n            }}\n            src={currentUser?.avatar || '/default-user-icon.png'}\n          />\n        </Dropdown>\n      </>\n    ) : (\n      <Button\n        className=\"btn-login\"\n        onClick={() => Router.push('/auth/login/user', '/auth/login')}\n      >\n        Login\n      </Button>\n    );\n\n    return (\n      <Layout.Header className=\"header\" id=\"layoutHeader\">\n        <div className=\"left-container\">\n          <Link href=\"/\">\n            <a className=\"header-logo\">\n              <img\n                src={\n                  typeof ui.logo === 'string' && ui.logo.length > 0\n                    ? ui.logo\n                    : '/xcam-logo-white.png'\n                }\n                alt=\"header-logo\"\n              />\n            </a>\n          </Link>\n          <div className=\"menu-left-header\">\n            <LeftHeaderContent {...this.props} />\n          </div>\n        </div>\n        <div className=\"right-container\">\n          <div\n            className={showSearch ? 'search-icon active' : 'search-icon'}\n            aria-hidden\n            onClick={() => this.setState({ showSearch: !showSearch })}\n          >\n            {showSearch ? <CloseOutlined /> : <SearchOutlined />}\n          </div>\n          <div className={!showSearch ? 'hide search-bar' : 'search-bar'}>\n            <Input.Search\n              placeholder=\"Enter keyword\"\n              loading={false}\n              allowClear\n              enterButton\n              onPressEnter={this.onPressEnter.bind(this)}\n              onSearch={this.onSearchPerformer.bind(this)}\n            />\n          </div>\n          {rightContent}\n        </div>\n      </Layout.Header>\n    );\n  }\n}\n\nHeader.contextType = SocketContext;\n\nconst userSelecter = (state) => state.user.current;\nconst performerSelecter = (state) => state.performer.current;\nconst studioSelecter = (state) => state.studio.current;\nconst authSelecter = (state) => state.auth;\n\nconst currentUserSelecter = createSelector(\n  userSelecter,\n  performerSelecter,\n  studioSelecter,\n  authSelecter,\n  (user, performer, studio, auth) => {\n    if (!auth.loggedIn) return {};\n\n    if (user?._id) {\n      return { ...user, role: 'user' };\n    }\n\n    if (performer?._id) {\n      return { ...performer, role: 'performer' };\n    }\n\n    if (studio?._id) {\n      return { ...studio, role: 'studio' };\n    }\n\n    return {};\n  }\n);\n\nHeader.contextType = SocketContext;\n\nconst mapStateToProps = (state: any) => ({\n  ui: { ...state.ui },\n  currentUser: currentUserSelecter(state),\n  tipSound: state.settings.tipSound,\n  loggedIn: state.auth.loggedIn,\n  performerCategories: state.performer.categories,\n  totalNotReadMessage: state.message.totalNotReadMessage,\n  ...state.streaming\n});\nconst mapDispatch = {\n  logout,\n  getPerformerCategories,\n  getCountries,\n  addPrivateRequest,\n  getStudioStats,\n  countNotReadMessage,\n  updateCurrentPerformerBalance\n};\nexport default connect(mapStateToProps, mapDispatch)(withRouter(Header));\n"]},"metadata":{},"sourceType":"module"}